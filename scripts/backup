#!/bin/bash

SSH_AGENT="/usr/bin/ssh-agent"
SSH_ADD="/usr/bin/ssh-add"
GIT="/usr/bin/git"

# Start SSH agent and add SSH key
eval "$($SSH_AGENT -s)"
$SSH_ADD ~/.ssh/id_ed25519

# backup dwm setup
DWM_DIR="$HOME/.dwm-setup"
cd $DWM_DIR || exit
if [[ -n "$($GIT status --porcelain)" ]]; then
  git add .
  git commit -m "Automated update: $(date --rfc-3339 s)"
  git push -u origin main
fi

# backup dotfiles
DOTFILES_DIR="$HOME/.dotfiles"
cd $DOTFILES_DIR || exit
if [[ -n "$($GIT status --porcelain)" ]]; then
  git add .
  git commit -m "Automated update: $(date --rfc-3339 s)"
  git push -u origin main
fi
